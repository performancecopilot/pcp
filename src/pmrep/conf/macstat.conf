#
# pmrep(1) configuration file - macOS-specific system statistics
#
# Mimics pmstat(1) output format but adapted for macOS memory model
# and available darwin PMDA metrics
#
# Usage:
#   pmrep :macstat          # basic macOS system statistics
#   pmrep :macstat-x        # extended statistics with compressor activity
#

#
# Basic macOS system statistics
# Similar to pmstat but using macOS memory model (wired/active/compressed)
# instead of Linux model (buff/cache), and pageins/pageouts instead of
# swap in/out since macOS memory management differs fundamentally.
#
[macstat]
header = yes
unitinfo = no
globals = no
timestamp = no
precision = 0
delimiter = " "
repeat_header = auto

# Load average
kernel.all.load = load avg,1 minute,,,8

# Memory metrics (macOS memory model)
# Note: swap.used from PR #2421 - uncomment when available
#swap.used = swpd,,MB,,6
mem.util.free = free,,MB,,6
mem.util.wired = wired,,MB,,6
mem.util.active = active,,MB,,6
mem.util.compressed = cmpr,,MB,,6

# Paging activity (not swap - macOS pages in/out from compressed memory)
mem.pageins = pi,,,,5
mem.pageouts = po,,,,5

# Disk I/O
disk.all.read = read,,,,6
disk.all.write = write,,,,6

# CPU utilization percentages
usr = kernel.all.cpu.usrp
usr.label = us
usr.formula = 100 * (kernel.all.cpu.user + kernel.all.cpu.nice) / hinv.ncpu
usr.unit = s
usr.width = 3

sys = kernel.all.cpu.sysp
sys.label = sy
sys.formula = 100 * kernel.all.cpu.sys / hinv.ncpu
sys.unit = s
sys.width = 3

idle = kernel.all.cpu.idlep
idle.label = id
idle.formula = 100 * kernel.all.cpu.idle / hinv.ncpu
idle.unit = s
idle.width = 3

#
# Extended macOS system statistics
# Includes memory compressor activity and process/thread counts
# which are unique to macOS and provide insight into system behavior
#
[macstat-x]
header = yes
unitinfo = no
globals = no
timestamp = no
precision = 0
delimiter = " "
repeat_header = auto

# Load average
kernel.all.load = load avg,1 minute,,,8

# Memory metrics (expanded to include inactive)
# Note: swap.used from PR #2421 - uncomment when available
#swap.used = swpd,,MB,,6
mem.util.free = free,,MB,,6
mem.util.wired = wired,,MB,,6
mem.util.active = active,,MB,,6
mem.util.inactive = inact,,MB,,6
mem.util.compressed = cmpr,,MB,,6

# Paging activity
mem.pageins = pi,,,,5
mem.pageouts = po,,,,5

# Memory compressor activity (macOS-specific)
# These show compression/decompression rates - key to understanding
# macOS memory pressure and performance
mem.compressions = comp,,,,5
mem.decompressions = deco,,,,5

# Disk I/O
disk.all.read = read,,,,6
disk.all.write = write,,,,6

# Process and thread counts
kernel.all.nprocs = proc,,,,5
kernel.all.nthreads = thrd,,,,5

# CPU utilization percentages
usr = kernel.all.cpu.usrp
usr.label = us
usr.formula = 100 * (kernel.all.cpu.user + kernel.all.cpu.nice) / hinv.ncpu
usr.unit = s
usr.width = 3

sys = kernel.all.cpu.sysp
sys.label = sy
sys.formula = 100 * kernel.all.cpu.sys / hinv.ncpu
sys.unit = s
sys.width = 3

idle = kernel.all.cpu.idlep
idle.label = id
idle.formula = 100 * kernel.all.cpu.idle / hinv.ncpu
idle.unit = s
idle.width = 3
